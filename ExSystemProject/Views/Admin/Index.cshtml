@{
    ViewData["Title"] = "Admin Dashboard";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div class="container-fluid px-4">
    <h1 class="mt-4">Admination Dashboard</h1>
    <ol class="breadcrumb mb-4">
        <li class="breadcrumb-item active">System Overview</li>
    </ol>

    <!-- Statistics Cards -->
    <div class="row">
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card shadow h-100 py-2 border-left-primary">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col">
                            <div class="text-xs fw-bold text-uppercase mb-1">Students</div>
                            <div class="h5 mb-0 fw-bold">@ViewBag.ActiveStudentCount / @ViewBag.StudentCount</div>
                            <div class="small text-muted">Active / Total</div>
                        </div>
                        <div class="col-auto">
                            <i class="bi bi-people-fill fa-2x text-primary"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card shadow h-100 py-2 border-left-success">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col">
                            <div class="text-xs fw-bold text-uppercase mb-1">Instructors</div>
                            <div class="h5 mb-0 fw-bold">@ViewBag.ActiveInstructorCount / @ViewBag.InstructorCount</div>
                            <div class="small text-muted">Active / Total</div>
                        </div>
                        <div class="col-auto">
                            <i class="bi bi-person-workspace fa-2x text-success"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card shadow h-100 py-2 border-left-info">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col">
                            <div class="text-xs fw-bold text-uppercase mb-1">Courses</div>
                            <div class="h5 mb-0 fw-bold">@ViewBag.ActiveCourseCount / @ViewBag.CourseCount</div>
                            <div class="small text-muted">Active / Total</div>
                        </div>
                        <div class="col-auto">
                            <i class="bi bi-book fa-2x text-info"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card shadow h-100 py-2 border-left-warning">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col">
                            <div class="text-xs fw-bold text-uppercase mb-1">Exams</div>
                            <div class="h5 mb-0 fw-bold">@ViewBag.ActiveExamCount / @ViewBag.ExamCount</div>
                            <div class="small text-muted">Active / Total</div>
                        </div>
                        <div class="col-auto">
                            <i class="bi bi-file-earmark-text fa-2x text-warning"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row mb-4">
        <div class="col-xl-6 col-md-6 mb-4">
            <div class="card shadow h-100 py-2 border-left-primary">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col">
                            <div class="text-xs fw-bold text-uppercase mb-1">Branches</div>
                            <div class="h5 mb-0 fw-bold">@ViewBag.ActiveBranchCount / @ViewBag.BranchCount</div>
                            <div class="small text-muted">Active / Total</div>
                        </div>
                        <div class="col-auto">
                            <i class="bi bi-building fa-2x text-primary"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-6 col-md-6 mb-4">
            <div class="card shadow h-100 py-2 border-left-success">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col">
                            <div class="text-xs fw-bold text-uppercase mb-1">Tracks</div>
                            <div class="h5 mb-0 fw-bold">@ViewBag.ActiveTrackCount / @ViewBag.TrackCount</div>
                            <div class="small text-muted">Active / Total</div>
                        </div>
                        <div class="col-auto">
                            <i class="bi bi-diagram-3 fa-2x text-success"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Charts -->
    <div class="row">
        <div class="col-xl-6">
            <div class="card mb-4">
                <div class="card-header">
                    <i class="bi bi-bar-chart-line me-1"></i>
                    Students per Branch
                </div>
                <div class="card-body">
                    <canvas id="studentsChart" width="100%" height="40"></canvas>
                </div>
            </div>
        </div>
        <div class="col-xl-6">
            <div class="card mb-4">
                <div class="card-header">
                    <i class="bi bi-bar-chart-line me-1"></i>
                    Instructors per Branch
                </div>
                <div class="card-body">
                    <canvas id="instructorsChart" width="100%" height="40"></canvas>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-xl-6">
            <div class="card mb-4">
                <div class="card-header">
                    <i class="bi bi-bar-chart-line me-1"></i>
                    Tracks per Branch
                </div>
                <div class="card-body">
                    <canvas id="tracksChart" width="100%" height="40"></canvas>
                </div>
            </div>
        </div>
        <div class="col-xl-6">
            <div class="card mb-4">
                <div class="card-header">
                    <i class="bi bi-pie-chart me-1"></i>
                    System Overview
                </div>
                <div class="card-body">
                    <canvas id="systemOverviewChart" width="100%" height="40"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="card mb-4">
        <div class="card-header">
            <i class="bi bi-lightning-charge me-1"></i>
            Quick Actions
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-3 mb-2">
                    <a asp-controller="AdminStudent" asp-action="Index" class="btn btn-primary w-100">
                        <i class="bi bi-people me-2"></i> Manage Students
                    </a>
                </div>
                <div class="col-md-3 mb-2">
                    <a asp-controller="AdminInstructor" asp-action="Index" class="btn btn-success w-100">
                        <i class="bi bi-person-workspace me-2"></i> Manage Instructors
                    </a>
                </div>
                <div class="col-md-3 mb-2">
                    <a asp-controller="AdminCourse" asp-action="Index" class="btn btn-info w-100">
                        <i class="bi bi-book me-2"></i> Manage Courses
                    </a>
                </div>
                <div class="col-md-3 mb-2">
                    <a asp-controller="AdminExam" asp-action="Index" class="btn btn-warning w-100">
                        <i class="bi bi-file-earmark-text me-2"></i> Manage Exams
                    </a>
                </div>
            </div>
            <div class="row mt-2">
                <div class="col-md-3 mb-2">
                    <a asp-controller="Branch" asp-action="Index" class="btn btn-primary w-100">
                        <i class="bi bi-building me-2"></i> Manage Branches
                    </a>
                </div>
                <div class="col-md-3 mb-2">
                    <a asp-controller="Track" asp-action="Index" class="btn btn-success w-100">
                        <i class="bi bi-diagram-3 me-2"></i> Manage Tracks
                    </a>
                </div>
                <div class="col-md-3 mb-2">
                    <a asp-controller="AdminManager" asp-action="Index" class="btn btn-info w-100">
                        <i class="bi bi-people-fill me-2"></i> Manage Managers
                    </a>
                </div>
                <div class="col-md-3 mb-2">
                    <a asp-controller="Account" asp-action="Logout" class="btn btn-danger w-100">
                        <i class="bi bi-box-arrow-right me-2"></i> Logout
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

@section Styles {
    <style>
        .border-left-primary {
            border-left: 4px solid #a41e22 !important;
        }

        .border-left-success {
            border-left: 4px solid #1e3a47 !important;
        }

        .border-left-info {
            border-left: 4px solid #2a7d8c !important;
        }

        .border-left-warning {
            border-left: 4px solid #f6c23e !important;
        }

        .text-xs {
            font-size: 0.7rem;
        }

        .text-primary {
            color: #a41e22 !important;
        }

        .text-success {
            color: #1e3a47 !important;
        }

        .text-info {
            color: #2a7d8c !important;
        }

        .text-warning {
            color: #f6c23e !important;
        }

        .btn-primary {
            background-color: #a41e22;
            border-color: #a41e22;
        }

            .btn-primary:hover {
                background-color: #8a1a1e;
                border-color: #8a1a1e;
            }

        .btn-success {
            background-color: #1e3a47;
            border-color: #1e3a47;
        }

            .btn-success:hover {
                background-color: #19313d;
                border-color: #19313d;
            }

        .btn-info {
            background-color: #2a7d8c;
            border-color: #2a7d8c;
            color: white;
        }

            .btn-info:hover {
                background-color: #236b78;
                border-color: #236b78;
                color: white;
            }
    </style>
}

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Get branch data from ViewBag
        const branchNames = @Html.Raw(Json.Serialize(ViewBag.BranchNames));
        const studentsData = @Html.Raw(Json.Serialize(ViewBag.StudentsPerBranch));
        const instructorsData = @Html.Raw(Json.Serialize(ViewBag.InstructorsPerBranch));
        const tracksData = @Html.Raw(Json.Serialize(ViewBag.TracksPerBranch));

        // Chart colors
        const colors = ['#a41e22', '#1e3a47', '#2a7d8c', '#f6c23e', '#5a5c69', '#858796'];

        // Students per Branch
        const studentsChart = new Chart(document.getElementById("studentsChart"), {
            type: 'bar',
            data: {
                labels: branchNames,
                datasets: [{
                    label: 'Students',
                    backgroundColor: colors[0],
                    borderColor: colors[0],
                    data: studentsData,
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            precision: 0
                        }
                    }
                }
            }
        });

        // Instructors per Branch
        const instructorsChart = new Chart(document.getElementById("instructorsChart"), {
            type: 'bar',
            data: {
                labels: branchNames,
                datasets: [{
                    label: 'Instructors',
                    backgroundColor: colors[1],
                    borderColor: colors[1],
                    data: instructorsData,
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            precision: 0
                        }
                    }
                }
            }
        });

        // Tracks per Branch
        const tracksChart = new Chart(document.getElementById("tracksChart"), {
            type: 'bar',
            data: {
                labels: branchNames,
                datasets: [{
                    label: 'Tracks',
                    backgroundColor: colors[2],
                    borderColor: colors[2],
                    data: tracksData,
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            precision: 0
                        }
                    }
                }
            }
        });

        // System Overview Chart
        const systemOverviewChart = new Chart(document.getElementById("systemOverviewChart"), {
            type: 'doughnut',
            data: {
                labels: ['Students', 'Instructors', 'Courses', 'Exams', 'Branches', 'Tracks'],
                datasets: [{
                    data: [
        @ViewBag.StudentCount,
        @ViewBag.InstructorCount,
        @ViewBag.CourseCount,
        @ViewBag.ExamCount,
        @ViewBag.BranchCount,
        @ViewBag.TrackCount
                    ],
                    backgroundColor: colors,
                    hoverOffset: 4
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'right',
                    }
                }
            }
        });
    </script>
}
