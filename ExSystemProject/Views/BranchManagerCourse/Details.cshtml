@model ExSystemProject.Models.Course
@{
    ViewData["Title"] = "Course Details";
    Layout = "~/Views/Shared/_BranchManagerLayout.cshtml";
}

<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">Course Details: @Model.CrsName</h5>
        <div>
            <a asp-action="Index" class="btn btn-sm btn-secondary">
                <i class="bi bi-arrow-left me-1"></i> Back to List
            </a>
            <a asp-action="Edit" asp-route-id="@Model.CrsId" class="btn btn-sm btn-primary">
                <i class="bi bi-pencil me-1"></i> Edit
            </a>
            <a asp-action="Topics" asp-route-id="@Model.CrsId" class="btn btn-sm btn-success">
                <i class="bi bi-list-check me-1"></i> Manage Topics
            </a>
        </div>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <h4>Course Information</h4>
                <hr />
                <dl class="row">
                    <dt class="col-sm-4">Course Name</dt>
                    <dd class="col-sm-8">@Model.CrsName</dd>

                    <dt class="col-sm-4">Duration</dt>
                    <dd class="col-sm-8">@(Model.CrsPeriod.HasValue ? $"{Model.CrsPeriod} days" : "Not specified")</dd>

                    <dt class="col-sm-4">Status</dt>
                    <dd class="col-sm-8">
                        @if (Model.Isactive == true)
                        {
                            <span class="badge bg-success">Active</span>
                        }
                        else
                        {
                            <span class="badge bg-danger">Inactive</span>
                        }
                    </dd>

                    <dt class="col-sm-4">Instructor</dt>
                    <dd class="col-sm-8">@(Model.Ins?.User?.Username ?? "Not Assigned")</dd>

                    <dt class="col-sm-4">Description</dt>
                    <dd class="col-sm-8">@(string.IsNullOrEmpty(Model.description) ? "No description available" : Model.description)</dd>
                </dl>
            </div>
            <div class="col-md-6">
                @if (!string.IsNullOrEmpty(Model.Poster))
                {
                    <img src="~/images/courses/@Model.Poster" class="img-fluid rounded" alt="@Model.CrsName poster" style="max-height: 300px; object-fit: cover;" />
                }
                else
                {
                    <img src="~/images/courses/default-course.jpg" class="img-fluid rounded" alt="Default course image" style="max-height: 300px; object-fit: cover;" />
                }
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-md-6">
                <h4>Topics</h4>
                <hr />
                @if (ViewBag.Topics != null && ViewBag.Topics.Count > 0)
                {
                    <ul class="list-group">
                        @foreach (var topic in ViewBag.Topics)
                        {
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                @topic.TopicName
                                @if (topic.Isactive == true)
                                {
                                    <span class="badge bg-success rounded-pill">Active</span>
                                }
                                else
                                {
                                    <span class="badge bg-danger rounded-pill">Inactive</span>
                                }
                            </li>
                        }
                    </ul>
                }
                else
                {
                    <p class="text-muted">No topics available for this course</p>
                }
                <a asp-action="Topics" asp-route-id="@Model.CrsId" class="btn btn-outline-primary mt-2">
                    <i class="bi bi-list-check me-1"></i> Manage Topics
                </a>
            </div>

            <div class="col-md-6">
                <h4>Exams</h4>
                <hr />
                @if (ViewBag.Exams != null && ViewBag.Exams.Count > 0)
                {
                    <ul class="list-group">
                        @foreach (var exam in ViewBag.Exams)
                        {
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                @exam.ExamName
                                <div>
                                    <small class="text-muted">@exam.StartTime?.ToString("dd/MM/yyyy HH:mm")</small>
                                    @if (exam.Isactive == true)
                                    {
                                        <span class="badge bg-success rounded-pill ms-2">Active</span>
                                    }
                                    else
                                    {
                                        <span class="badge bg-danger rounded-pill ms-2">Inactive</span>
                                    }
                                </div>
                            </li>
                        }
                    </ul>
                }
                else
                {
                    <p class="text-muted">No exams available for this course</p>
                }
            </div>
        </div>
    </div>
</div>
